  METHOD setUser.
  DATA lt_items_upd TYPE TABLE FOR UPDATE zdemo_i_param.
  lt_items_upd = CORRESPONDING #( keys ).
  loop at lt_items_upd ASSIGNING FIELD-SYMBOL(<ls_items_upd>).
  <ls_items_upd>-Uname = sy-uname.
  ENDLOOP.
  modify entity IN LOCAL MODE zdemo_i_param UPDATE FIELDS ( Uname  ) with lt_items_upd REPORTED data(ls_reported).
  reported = CORRESPONDING #( DEEP ls_reported ).
  ENDMETHOD.


  METHOD execute.
  READ ENTITY IN LOCAL MODE zdemo_i_param ALL FIELDS WITH CORRESPONDING #( keys ) RESULT DATA(lt_params).
  loop at lt_params ASSIGNING FIELD-SYMBOL(<ls_params>).
  select single * into @data(class_details)
    from zdemo_i_param  where parguid = @<ls_params>-parguid.
    call method (class_details-class_name)=>main EXPORTING parguid = class_details-parguid .
    data(lastrun) = |{ sy-datlo date = user  } { sy-timlo time = user }|.    
    update zdemo_param SET lastrun = @lastrun    where parguid = @<ls_params>-parguid.


  endloop.


  ENDMETHOD.
METHOD clear.    
READ ENTITY IN LOCAL MODE zdemo_i_param ALL FIELDS WITH CORRESPONDING #( keys ) RESULT DATA(lt_params).  
loop at lt_params ASSIGNING FIELD-SYMBOL(<ls_params>).   
zparam_helper=>clear_output( parguid = <ls_params>-parguid ).    
update zdemo_param SET lastrun = ''    where parguid = @<ls_params>-parguid.  
endloop.  
endmethod.




